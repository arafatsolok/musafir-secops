syntax = "proto3";

package musafir.v1;

option go_package = "github.com/musafirsec/musafir/proto/gen/go/musafir/v1;musafirv1";

message Asset {
  string id = 1;
  string type = 2;
  string os = 3;
  string ip = 4;
}

message User {
  string id = 1;
  string sid = 2;
}

message EventAttr {
  map<string, string> fields = 1;
}

message Event {
  string class = 1;
  string name = 2;
  int32 severity = 3;
  EventAttr attrs = 4;
}

message Ingest {
  string agent_version = 1;
  string schema = 2;
}

message EventEnvelope {
  string ts = 1;
  string tenant_id = 2;
  Asset asset = 3;
  User user = 4;
  Event event = 5;
  Ingest ingest = 6;
}
